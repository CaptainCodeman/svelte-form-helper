import{w as E,d as M}from"./index.efb157be.js";const O={dirty:!1,touched:!1,show:!1,message:"",badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!1,valueMissing:!1};function j(r,c){const t=F(),{onDirty:a,onTouched:n,validator:y}={onDirty:!1,onTouched:!0,...c},s={id:t,...O},{subscribe:m,set:g}=E(s),o=Object.assign(e=>{r.add(o);let u;async function i(l=!1,d=!1){const L=u=new Object;if(e.checkValidity()&&y&&!(e instanceof HTMLFieldSetElement)){const w=await y(e.value);if(L!==u)return;w&&e.setCustomValidity(w)}s.dirty=s.dirty||d,s.touched=s.touched||l,s.show=!e.validity.valid&&(a&&s.dirty||n&&s.touched),Object.assign(s,{message:e.validationMessage,...V(e.validity)}),g(s),f(e,s.show,"data-show"),f(e,s.dirty,"data-dirty"),f(e,s.touched,"data-touched"),f(e,s.show,"aria-invalid","true"),f(e,s.show,"aria-describedby",t)}function h(l){i(!0,!1)}function v(l){e.setCustomValidity(""),i(!1,!0)}return i(),e.addEventListener("blur",h),e.addEventListener("input",v),{destroy(){r.del(o),e.removeEventListener("blur",h),e.removeEventListener("input",v)}}},{subscribe:m});return o}function V(r){const c={};for(const t in r)c[t]=r[t];return c}let A=0;const F=()=>`form-help:${++A}`,f=(r,c,t,a="")=>{c?r.setAttribute(t,a):r.removeAttribute(t)};function D(){const{subscribe:r,set:c}=E({dirty:!1,touched:!1,valid:!0});let t=[],a;function n(o,e){e&&e();const{subscribe:u}=M(o,i=>{const h=i.every(d=>d.valid),v=i.some(d=>d.dirty),l=i.some(d=>d.touched);return{dirty:v,touched:l,valid:h}});return u(i=>c(i))}const b=Object.assign(o=>(o.noValidate=!0,a=n(t,a),{destroy(){a&&a(),a=void 0}}),{subscribe:r,field:o=>j(b,o),add:o=>{t.includes(o)||(t.push(o),a=n(t,a))},del:o=>{t=t.filter(e=>e!==o),a=n(t,a)}});return b}export{D as c};
